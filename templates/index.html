<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>{{ app_name }}</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<style>
:root{
  --bg:#07070a;
  --card:#0f0f14;
  --text:#f5f5f7;
  --muted:#a1a1aa;
  --border:rgba(255,255,255,.10);
  --red:#ff2a2a;
  --red2:#b60000;
  --green:#2ee59d;
  --yellow:#ffd166;
  --radius:16px;
  --shadow:0 14px 35px rgba(0,0,0,.45);
}

*{box-sizing:border-box;}

body{
  font-family:-apple-system,BlinkMacSystemFont,"Inter","Segoe UI",Roboto,Helvetica,Arial,sans-serif;
  background:radial-gradient(1200px 600px at 15% 0%, rgba(255,42,42,.14), transparent 55%),
             var(--bg);
  color:var(--text);
  padding:34px 18px;
  max-width:1060px;
  margin:0 auto;
  line-height:1.55;
}

header{
  display:flex;
  justify-content:space-between;
  align-items:flex-end;
  margin-bottom:18px;
}

h1{margin:0;font-size:28px;}

.pill{
  padding:8px 12px;
  border-radius:999px;
  background:rgba(255,42,42,.10);
  border:1px solid rgba(255,42,42,.25);
  font-size:12px;
}

form{display:flex;gap:10px;flex-wrap:wrap;}

input{
  flex:1;
  min-width:220px;
  padding:12px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.35);
  color:#fff;
}

button{
  padding:12px 16px;
  border-radius:12px;
  border:1px solid rgba(255,42,42,.4);
  background:linear-gradient(180deg,var(--red),var(--red2));
  color:#fff;
  font-weight:800;
  cursor:pointer;
}

.grid{margin-top:20px;display:grid;gap:14px;}

.card{
  background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:18px;
  box-shadow:var(--shadow);
}

.card-head{
  cursor:pointer;
}

.card-head h2{
  margin:0;
  font-size:17px;
}

.highlight{
  border:1px solid rgba(46,229,157,.6);
  background:rgba(46,229,157,.08);
}

.section{
  margin-top:14px;
  padding-top:14px;
  border-top:1px solid rgba(255,255,255,.08);
}

.label{
  font-weight:800;
  font-size:13px;
  margin-bottom:6px;
}

ul{padding-left:18px;}

.paywall{
  margin-top:20px;
  padding:22px;
  border-radius:var(--radius);
  border:1px dashed rgba(255,42,42,.45);
  text-align:center;
}

#scannerOverlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.8);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:9999;
}

.scannerBox{
  width:min(700px,100%);
  background:var(--card);
  padding:20px;
  border-radius:20px;
  border:1px solid var(--border);
}

.scanBar{
  height:10px;
  border-radius:999px;
  background:rgba(255,255,255,.08);
  overflow:hidden;
  margin:12px 0;
}

.scanBar div{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,var(--red),var(--red2));
  transition:width .3s ease;
}

.step{
  display:flex;
  gap:10px;
  margin-bottom:8px;
  font-size:13px;
}

.step .dot{
  width:10px;
  height:10px;
  border-radius:50%;
  background:var(--red);
  transition:all .3s ease;
}

.step.complete .dot{
  background:var(--green);
  box-shadow:0 0 0 6px rgba(46,229,157,.15);
}

.step.complete{
  color:var(--green);
}
</style>
</head>

<body>

<div id="scannerOverlay">
  <div class="scannerBox">
    <div><strong id="scanTitle">ðŸ”´ Scanning your territoryâ€¦</strong></div>
    <div class="scanBar"><div id="progressFill"></div></div>

    <div class="step"><div class="dot"></div>Locating businessesâ€¦</div>
    <div class="step"><div class="dot"></div>Scoring signal strengthâ€¦</div>
    <div class="step"><div class="dot"></div>Generating outreach assetsâ€¦</div>
    <div class="step"><div class="dot"></div>Mapping decision makersâ€¦</div>
  </div>
</div>

<header>
  <div>
    <h1>{{ app_name }}</h1>
    <div style="color:var(--muted);font-size:14px;">
      Territory intelligence that feels curated â€” not a giant list.
    </div>
  </div>
  <div class="pill">Vertical: Payroll / HR</div>
</header>

<form method="post" action="/generate" id="scanForm">
  <input name="zip_codes" placeholder="Zip codes (comma separated)" required />
  <input name="industry" placeholder="Industry (optional)" />
  <button type="submit">ðŸ”¥ Scan Territory</button>
</form>

{% if results %}
<div class="grid">
{% for r in results %}
<div class="card {% if loop.index == 1 %}highlight{% endif %}">

  <div class="card-head" onclick="toggleCard('card-{{ loop.index }}')">
    <h2>
      {{ loop.index }}. {{ r.name }} â€” {{ r.priority_score }}/10
      {% if r.priority_score >= 8 %}
        ðŸ”¥ <span style="color:var(--green);">High Signal</span>
      {% elif r.priority_score >= 5 %}
        âš¡ <span style="color:var(--yellow);">Mid Signal</span>
      {% else %}
        ðŸ’¤ <span style="color:#aaa;">Low Signal</span>
      {% endif %}
    </h2>
  </div>

  <div id="card-{{ loop.index }}" style="display:none;">
    <div class="section">
      <div class="label">Why this account matters</div>
      {{ r.reason }}
    </div>

    <div class="section">
      <div class="label">Likely Decision Makers</div>
      <ul>
        {% for e in r.executives %}
        <li><a href="{{ e.linkedin_url }}" target="_blank">{{ e.name }}</a> â€” {{ e.title }}</li>
        {% endfor %}
      </ul>
    </div>

    <div class="section">
      <div class="label">Suggested Cold Email</div>
      <pre>{{ r.email_draft }}</pre>
    </div>
  </div>

</div>
{% endfor %}
</div>
{% endif %}

{% if not is_premium and locked_count > 0 %}
<div class="paywall">
  <h2>ðŸ”’ {{ locked_count }} More High-Signal Accounts Hidden</h2>
  <form method="post" action="/start-checkout">
    <input type="email" name="email" placeholder="Work email for Pro access" required />
    <button type="submit">Unlock SignalZip Pro</button>
  </form>
</div>
{% endif %}

<script>
function toggleCard(id){
  const el=document.getElementById(id);
  el.style.display=el.style.display==="none"?"block":"none";
}

const form=document.getElementById("scanForm");
const overlay=document.getElementById("scannerOverlay");
const progress=document.getElementById("progressFill");
const steps=document.querySelectorAll(".step");
const title=document.getElementById("scanTitle");

if(form){
form.addEventListener("submit",()=>{
  overlay.style.display="flex";
  let pct=0;
  let stepIndex=0;

  const interval=setInterval(()=>{
    pct+=4;
    progress.style.width=pct+"%";

    if(pct>=((stepIndex+1)*25) && steps[stepIndex]){
      steps[stepIndex].classList.add("complete");
      stepIndex++;
    }

    if(pct>=100){
      clearInterval(interval);
      progress.style.background="linear-gradient(90deg,var(--green),#1dbf73)";
      title.innerText="ðŸŸ¢ Scan Complete â€” Loading Results...";
    }
  },120);
});
}
</script>

</body>
</html>
